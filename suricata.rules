# simple_hel 
# 
alert tcp 127.0.0.1 any -> 127.0.0.1 4840 (msg: "HELLO opcua packet (from client)"; content: "HEL"; offset: 0;depth: 3; ) 

# simple_ack 
# 
alert tcp 127.0.0.1 4840 -> 127.0.0.1 any (msg: "ACK opcua packet (from server)"; content: "ACK"; startswith; ) 

# simple_opn 
# 
alert tcp 127.0.0.1 any <> 127.0.0.1 4840 (msg: "OPN opcua packet"; content: "OPN"; offset: 0; depth: 3; ) 

# create_session_request 
# 
alert tcp 127.0.0.1 any -> 127.0.0.1 4840 (msg: "CreateSessionRequest by opcua client"; content: "|cd 01|"; offset: 26;depth: 28; rawbytes; ) 

# ns_i 
# 
alert tcp 127.0.0.1 any -> 127.0.0.1 4840 (msg: "connect to ns=2,i=2"; content: "|02 00|"; content: "|02 00 00 00|"; distance: 0; within: 4; rawbytes; ) 

# 100bytes_msg 
# 
alert tcp 127.0.0.1 any -> 127.0.0.1 4840 (msg: "client WriteRequest length is more than 100"; dsize:>100; content: "|a1 02|"; offset: 26; depth: 28; rawbytes; ) 

# verybig_msg 
# 
alert tcp 127.0.0.1 4840 -> 127.0.0.1 any (msg: "extremely big message (>500)! this is CreateSessionResponse"; dsize:>500; content: "|d0 01|"; offset: 26; depth: 28; rawbytes; ) 

# check_certificate 
# 
alert tcp 127.0.0.1 4840 <> 127.0.0.1 any (msg: "the subscriber does not have a certificate for opening a secure channel !!"; content: "OPN"; content: "|ff ff ff ff|"; distance: 60; within: 64; rawbytes; )

# check_securechannel_forOPNmsg 
# 
alert tcp 127.0.0.1 4840 <> 127.0.0.1 any (msg: "secure channel not open for OPN msg !!"; content: "OPN"; content: "|00 00 00 00|"; distance: 5; within: 9; rawbytes; ) 

# drop_securechannel_forOPNmsg 
# 
drop tcp 127.0.0.1 4840 <> 127.0.0.1 any (msg: "secure channel not open for MSG msg !!"; content: "MSG"; content: "|00 00 00 00|"; distance: 5; within: 9; rawbytes; ) 

# check_status_writeresponse 
# 
alert tcp 127.0.0.1 4840 -> 127.0.0.1 any (msg: "WriteResponse status good (server)"; content: "|a4 02|"; content: "|00 00 00 00|"; distance: 12; within: 16; rawbytes; ) 

# detect_value1.0 
# 
alert tcp 127.0.0.1 any -> 127.0.0.1 4840 (msg: "written double value is 1.0 (client)"; content: "|a1 02|"; content: "|ff ff ff ff ff ff ef 3f|"; distance: 55; within: 63; rawbytes; ) 

# detect_firstwriterequest 
# 
alert tcp 127.0.0.1 any -> 127.0.0.1 4840 (msg: "the first WriteRequest"; content: "|04 00 00 00|"; content: "|a1 02|"; distance: 2; within:4; rawbytes; ) 

# check_activatesessionstatus 
# 
alert tcp 127.0.0.1 4840 -> 127.0.0.1 any (msg: "session activated!"; content: "|d6 01|"; content: "|00 00 00 00|"; distance: 12; within: 16; rawbytes; ) 

# check_byteF 
# 
alert tcp 127.0.0.1 any <> 127.0.0.1 4840 (msg: "opcua packet with chunk type F"; content: "F"; offset: 3;depth: 1; )

